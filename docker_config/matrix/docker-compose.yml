version: '3'
services: 
  synapse:
    image: matrixdotorg/synapse:latest
    container_name: synapse
    networks:
      - web
    labels:
      - traefik.http.routers.matrix.rule=Host(`matrix.jafner.net`)
      - traefik.http.routers.matrix.tls=true
      - traefik.http.routers.matrix.tls.certresolver=lets-encrypt
      - traefik.port=8008
    volumes:
      - ./data:/data
      - ./config:/config
    environment:
      - SYNAPSE_CONFIG_DIR=/config
      - UID=1000
      - GID=1000
      - TZ=America/Los_Angeles

volumes:
  synapse-data:
networks:
  web:
    external: true

