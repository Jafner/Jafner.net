services:
  vaultwarden:
    image: vaultwarden/server:1.33.2
    container_name: vaultwarden_vaultwarden
    restart: "no"
    env_file:
      - path: /run/secrets/vaultwarden
        required: true
    environment:
      DOMAIN: "https://bitwarden.jafner.net"
      SIGNUPS_ALLOWED: "true"
    volumes:
      - $APPDATA/data:/data
    networks:
      - web
    labels:
      - traefik.http.routers.vaultwarden.middlewares=securityheaders@file
      - traefik.http.routers.vaultwarden.rule=Host(`bitwarden.jafner.net`)
      - traefik.http.routers.vaultwarden.tls.certresolver=lets-encrypt
      - traefik.http.routers.vaultwarden.tls.options=tls12@file

networks:
  web:
    external: true
