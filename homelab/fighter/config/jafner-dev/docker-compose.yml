name: "jafner-dev"
version: '3.7'
services:
  jafner-dev:
    image: wordpress@sha256:c4d738408447e12b4ef6fa0a6413ed68eeec4af6a18edadfffac2bb998261e13
    container_name: jafner-dev
    env_file:
      - path: ./jafner-dev.env
        required: true
      - path: ./jafner-dev_secrets.env
        required: false
    restart: "no"
    volumes:
      - ${DOCKER_DATA}/html:/var/www/html
      - ./upload.ini:/usr/local/etc/php/conf.d/uploads.ini
    networks:
      - web
      - jafner-dev
    depends_on:
      - db
    labels:
       - traefik.http.routers.jafner-dev.rule=Host(`jafner.dev`)
       - traefik.http.routers.jafner-dev.tls.certresolver=lets-encrypt
  db:
    image: mysql@sha256:5107333e08a87b836d48ff7528b1e84b9c86781cc9f1748bbc1b8c42a870d933
    container_name: jafner-dev_db
    restart: "no"
    networks:
      - jafner-dev
    env_file:
      - path: ./db.env
        required: true
      - path: ./db_secrets.env
        required: false
    volumes:
      - ${DOCKER_DATA}/db:/var/lib/mysql
    labels:
      - traefik.enable=false

networks:
  web:
    external: true
  jafner-dev:
