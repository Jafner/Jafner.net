version: '3.2'
services:
  exatorrent:
    build: ./exatorrent # cloned from git@github.com:Jafner/exatorrent.git
    #image: ghcr.io/varbhat/exatorrent:latest
    container_name: exatorrent
    ports:
      - 5000:5000
      - 42069:42069
    volumes:
      - ${TORRENT_DATA}/torrents:/exa/exadir/torrents
      - ${DOCKER_DATA}/data:/exa/exadir/data
      - ${DOCKER_DATA}/config:/exa/exadir/config
      - ${DOCKER_DATA}/cache:/exa/exadir/cache
    networks:
      - web
    labels:
      - traefik.http.routers.exatorrent.rule=Host(`exa.jafner.net`)
      - traefik.http.routers.exatorrent.tls.certresolver=lets-encrypt
      - traefik.http.routers.exatorrent.middlewares=lan-only@file
      - traefik.http.services.exatorrent.loadbalancer.server.port=5000

networks:
  web:
    external: true